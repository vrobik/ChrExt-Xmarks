function HandleLoad(){LoadLocalizedStrings();var a=chrome.extension.getBackgroundPage();"true"==a.Xmarks.Settings.Get("first-run","false")&&(a.Xmarks.Settings.Set("first-run","false"),window.close(),a.StartSetupWizard())}
function LoadLocalizedStrings(){document.getElementById("xmarks-settings").innerHTML=chrome.i18n.getMessage("browseraction_settings");document.getElementById("my-xmarks").innerHTML=chrome.i18n.getMessage("browseraction_my_xmarks");document.getElementById("sync-now").innerHTML=chrome.i18n.getMessage("dialog_sync_now");document.getElementById("remote-tabs").innerHTML=chrome.i18n.getMessage("browseraction_remote_tabs")}function HandleOpenUrl(a){chrome.tabs.create({url:a});window.close()}
function OpenXmarksSettings(){var a=chrome.extension.getBackgroundPage();window.close();a.OpenExtensionUrl("settings.html")}function HandleSyncNow(){var a=chrome.extension.getBackgroundPage();window.close();a.HandleAction("sync")}function HandleOpenUrlList(a){chrome.extension.getBackgroundPage().OpenUrlsFromTabList(a)}
function UpdateRemoteTabDisplay(a,d){if(a)document.getElementById("tabs-loading").innerHTML="<div style='color: red'>"+chrome.i18n.getMessage("browseraction_remote_tabs_error",[a])+"</div>";else{var f=!1;forEach(d,function(a,d){var g=document.createElement("div");g.innerHTML='<div class="tab-display-row" style="margin-left: 10px"><img style="vertical-align:middle" src="images/computer.png"> '+d+" ("+a.length+")</div>";document.getElementById("tabs-display").appendChild(g);forEach(a.mids,function(a){forEach(a.windows,
function(d){var b=a.browserName,b=(b||"firefox").toLowerCase();0>["firefox","chrome","safari","ie"].indexOf(b)&&(b="firefox");var b='<img style="vertical-align:middle" src="'+("images/browser_"+b+".png")+'" /> ',c=a.browserName,c=(c||"firefox").toLowerCase();(c=chrome.i18n.getMessage("browseraction_browser_name_"+c))||(c="Firefox");var c='<span class="tab-display-link">'+c+" ("+d.tabs.length+")</span>",e=document.createElement("div");e.innerHTML='<div class="tab-display-row" style="margin-left: 30px">'+
b+c+"</div>";e.onclick=function(){HandleOpenUrlList(d.tabs)};document.getElementById("tabs-display").appendChild(e);forEach(d.tabs,function(a){var c='<img style="vertical-align:middle; height: 16px; width: 16px" src="'+(a.icon||"images/generic-favicon.png")+'" /> ',d='<span class="tab-display-link">'+(a.title||a.url)+"</span>",b=document.createElement("div");b.innerHTML='<div class="tab-display-row" style="margin-left: 50px">'+c+d+"</div>";b.onclick=function(){HandleOpenUrl(a.url)};document.getElementById("tabs-display").appendChild(b)})})});
f=!0});f?(document.getElementById("tabs-loading").style.display="none",document.getElementById("tabs-display").style.display="block"):document.getElementById("tabs-loading").innerHTML=chrome.i18n.getMessage("browseraction_remote_tabs_nodata")}}function HandleRemoteTabs(){document.getElementById("menu-items-ui").style.display="none";document.getElementById("remote-tabs-ui").style.display="block";chrome.extension.getBackgroundPage().LoadRemoteTabData(UpdateRemoteTabDisplay)}
document.addEventListener("DOMContentLoaded",function(){window.addEventListener("load",function(){HandleLoad()});document.getElementById("xmarks-settings").addEventListener("click",function(){OpenXmarksSettings()});document.getElementById("my-xmarks").addEventListener("click",function(){HandleOpenUrl("http://my.xmarks.com")});document.getElementById("sync-now").addEventListener("click",function(){HandleSyncNow()});document.getElementById("remote-tabs").addEventListener("click",function(){HandleRemoteTabs()})});
