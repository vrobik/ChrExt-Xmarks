function CreateAESManager(){function l(c,f){for(var b=f.length/4-1,d=[[],[],[],[]],a=0;16>a;a++)d[a%4][Math.floor(a/4)]=c[a];d=k(d,f,0,4);for(a=1;a<b;a++){for(var d=m(d,4),d=p(d,4),e=0;4>e;e++){for(var g=Array(4),h=Array(4),j=0;4>j;j++)g[j]=d[j][e],h[j]=d[j][e]&128?d[j][e]<<1^283:d[j][e]<<1;d[0][e]=h[0]^g[1]^h[1]^g[2]^g[3];d[1][e]=g[0]^h[1]^g[2]^h[2]^g[3];d[2][e]=g[0]^g[1]^h[2]^g[3]^h[3];d[3][e]=g[0]^h[0]^g[1]^g[2]^h[3]}d=k(d,f,a,4)}d=m(d,4);d=p(d,4);d=k(d,f,b,4);b=Array(16);for(a=0;16>a;a++)b[a]=
d[a%4][Math.floor(a/4)];return b}function m(c,f){for(var b=0;4>b;b++)for(var d=0;d<f;d++)c[b][d]=q[c[b][d]];return c}function p(c,f){for(var b=Array(4),d=1;4>d;d++){for(var a=0;4>a;a++)b[a]=c[d][(a+d)%f];for(a=0;4>a;a++)c[d][a]=b[a]}return c}function k(c,f,b,d){for(var a=0;4>a;a++)for(var e=0;e<d;e++)c[a][e]^=f[4*b+e][a];return c}function n(c){for(var f=c.length/4,b=f+6,d=Array(4*(b+1)),a=Array(4),e=0;e<f;e++)d[e]=[c[4*e],c[4*e+1],c[4*e+2],c[4*e+3]];for(e=f;e<4*(b+1);e++){d[e]=Array(4);for(c=0;4>
c;c++)a[c]=d[e-1][c];if(0==e%f){c=a[0];for(var g=0;4>g;g++)a[g]=a[g+1];a[3]=c;a=r(a);for(c=0;4>c;c++)a[c]^=v[e/f][c]}else 6<f&&4==e%f&&(a=r(a));for(c=0;4>c;c++)d[e][c]=d[e-f][c]^a[c]}return d}function r(c){for(var f=0;4>f;f++)c[f]=q[c[f]];return c}function w(c,f,b){if(!(128==b||192==b||256==b))return"";var d=b/8,a=Array(d);for(b=0;b<d;b++)a[b]=f.charCodeAt(b)&255;a=l(a,n(a));a=a.concat(a.slice(0,d-16));f=Array(16);d=(new Date).getTime();for(b=0;4>b;b++)f[b]=d>>>8*b&255;for(b=0;4>b;b++)f[b+4]=d/4294967296>>>
8*b&255;for(var a=n(a),e=Math.ceil(c.length/16),d=Array(e),g=0;g<e;g++){for(b=0;4>b;b++)f[15-b]=g>>>8*b&255;for(b=0;4>b;b++)f[15-b-4]=g/4294967296>>>8*b;var h=l(f,a),j=g<e-1?16:(c.length-1)%16+1,s=[];for(b=0;b<j;b++){var k=c.charCodeAt(16*g+b)^h[b];s.push(String.fromCharCode(k))}d[g]=t(s.join(""))}c=[];for(b=0;8>b;b++)c.push(String.fromCharCode(f[b]));return t(c.join("")).concat("-",d.join("-"))}function t(c){return c.replace(/[\0\t\n\v\f\r\xa0'"!-]/g,function(c){return"!"+c.charCodeAt(0)+"!"})}function u(c){return c.replace(/!\d\d?\d?!/g,
function(c){return String.fromCharCode(c.slice(1,-1))})}var q=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,
33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],v=[[0,0,0,0],[1,0,0,0],[2,
0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];return{encrypt:function(c,f){return Base64.encode(w(f,c,256),!1)},decrypt:function(c,f){var b;b=Base64.decode(f);for(var d=Array(32),a=0;32>a;a++)d[a]=c.charCodeAt(a)&255;a=n(d);a=l(d,a);a=a.concat(a.slice(0,16));d=n(a);b=b.split("-");for(var e=Array(16),g=u(b[0]),a=0;8>a;a++)e[a]=g.charCodeAt(a);for(var g=Array(b.length-1),h=1;h<b.length;h++){for(a=0;4>a;a++)e[15-a]=h-1>>>8*a&255;for(a=0;4>a;a++)e[15-a-
4]=h/4294967296-1>>>8*a&255;var j=l(e,d);b[h]=u(b[h]);for(var k=[],a=0;a<b[h].length;a++){var m=b[h].charCodeAt(a)^j[a];k.push(String.fromCharCode(m))}g[h-1]=k.join("")}b=g.join("");return b},utEncryption:function(c,f,b,d){c=c||1E3;for(f=f||255;c--;){for(var a="",e=f;e--;)var g=Math.floor(223*Math.random())+32,a=a+String.fromCharCode(g);b("Loop #"+c+"\n");b("String: "+a+"\n");e=this.encrypt("opensesame",a);e=this.decrypt("opensesame",e);b("DString: "+e+"\n");if(e!=a){d("Error in encryptor.");break}}}}}
;
